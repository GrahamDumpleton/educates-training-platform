{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {% block head_meta %}
    {% endblock %}
    <link rel="stylesheet" href="{% static "styles/bootstrap.min.css" %}" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static "styles/project.css" %}" crossorigin="anonymous">
    <link rel="shortcut icon" href="{% static "images/favicon.ico" %}"/>
    <title>{{ portal_title | escape }}</title>
    {% block head_styles %}
    {% endblock %}
    {% if google_tracking_id %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ google_tracking_id }}" nonce={{ request.csp_nonce }}></script>
    <script nonce={{ request.csp_nonce }}>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag("js", new Date());
      gtag('set',
      {
        'custom_map': {
            'dimension4': 'training_portal',
            'dimension5': 'ingress_domain',
            'dimension6': 'ingress_protocol'
        }
      });
      var gsettings = {
          'training_portal': '{{ training_portal }}',
          'ingress_domain': '{{ ingress_domain }}',
          'ingress_protocol': '{{ ingress_protocol }}'
      }
      if ('{{ ingress_protocol }}' == 'https')
          gsettings["cookie_flags"] = "max-age=86400;secure;samesite=none";
      gtag("config", "{{ google_tracking_id }}", gsettings);
    </script>
    {% endif %}
    {% if clarity_tracking_id %}
    <script nonce={{ request.csp_nonce }}>
      (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "{{ clarity_tracking_id }}");
      clarity("set", "training_portal", "{{ training_portal }}");
      clarity("set", "ingress_domain", "{{ ingress_domain }}");
      clarity("set", "ingress_protocol", "{{ ingress_protocol }}");
    </script>
    {% endif %}
    {% if amplitude_tracking_id %}
    <script nonce={{ request.csp_nonce }}>
    !function(){"use strict";!function(e,t){var n=e.amplitude||{_q:[],_iq:{}};if(n.invoked)e.console&&console.error&&console.error("Amplitude snippet has been loaded.");else{var r=function(e,t){e.prototype[t]=function(){return this._q.push({name:t,args:Array.prototype.slice.call(arguments,0)}),this}},s=function(e,t,n){return function(r){e._q.push({name:t,args:Array.prototype.slice.call(n,0),resolve:r})}},o=function(e,t,n){e[t]=function(){if(n)return{promise:new Promise(s(e,t,Array.prototype.slice.call(arguments)))}}},i=function(e){for(var t=0;t<y.length;t++)o(e,y[t],!1);for(var n=0;n<g.length;n++)o(e,g[n],!0)};n.invoked=!0;var a=t.createElement("script");a.type="text/javascript",a.integrity="sha384-TPZhteUkZj8CAyBx+GZZytBdkuKnhKsSKcCoVCq0QSteWf/Kw5Kb9oVFUROLE1l3",a.crossOrigin="anonymous",a.async=!0,a.src="https://cdn.amplitude.com/libs/analytics-browser-1.9.1-min.js.gz",a.onload=function(){e.amplitude.runQueuedFunctions||console.log("[Amplitude] Error: could not load SDK")};var c=t.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c);for(var u=function(){return this._q=[],this},l=["add","append","clearAll","prepend","set","setOnce","unset","preInsert","postInsert","remove","getUserProperties"],p=0;p<l.length;p++)r(u,l[p]);n.Identify=u;for(var d=function(){return this._q=[],this},f=["getEventProperties","setProductId","setQuantity","setPrice","setRevenue","setRevenueType","setEventProperties"],v=0;v<f.length;v++)r(d,f[v]);n.Revenue=d;var y=["getDeviceId","setDeviceId","getSessionId","setSessionId","getUserId","setUserId","setOptOut","setTransport","reset"],g=["init","add","remove","track","logEvent","identify","groupIdentify","setGroup","revenue","flush"];i(n),n.createInstance=function(e){return n._iq[e]={_q:[]},i(n._iq[e]),n._iq[e]},e.amplitude=n}}(window,document)}();
    amplitude.init("{{ amplitude_tracking_id }}", undefined, { defaultTracking: { sessions: true, pageViews: true, formInteractions: true, fileDownloads: true }})
    </script>
    {% endif %}
    {% if portal_head_html %}
    {{ portal_head_html|safe }}
    {% endif %}
  </head>
  <body>
    {% block navbar %}
    <nav class="navbar navbar-fixed-top navbar-light bg-dark">
    {% if portal_logo %}
    <a href="{% url 'index' %}"><img id="logo" class="portal-logo navbar-brand" src="{{ portal_logo | escape }}"></img></a>
    {% else %}
    <a href="{% url 'index' %}"><img id="logo" class="portal-logo navbar-brand" src="{% static "images/logo.png" %}"></img></a>
    {% endif %}
    <div class="text-white"><div>{{ portal_title | escape }}</div></div>
    </nav>
    {% endblock %}

    {% block content %}
    {% endblock %}

    <script src="{% static "scripts/jquery-3.7.1.min.js" %}" crossorigin="anonymous"></script>
    <script src="{% static "scripts/popper.min.js" %}" crossorigin="anonymous"></script>
    <script src="{% static "scripts/bootstrap.min.js" %}" crossorigin="anonymous"></script>

    {% block body_scripts %}
    {% endblock %}
  </body>
</html>
