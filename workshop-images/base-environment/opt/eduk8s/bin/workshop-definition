#!/bin/bash

if [ ! -f $HOME/.local/share/workshop/workshop-definition.json ]; then
    if [ -f /opt/eduk8s/config/workshop.yaml ]; then
        cp /opt/eduk8s/config/workshop.yaml $HOME/.local/share/workshop/workshop-definition.yaml
        ytt -f $HOME/.local/share/workshop/workshop-definition.yaml -o json >$HOME/.local/share/workshop/workshop-definition.json
    elif [ -f /opt/assets/files/resources/workshop.yaml ]; then
        cp /opt/assets/files/resources/workshop.yaml $HOME/.local/share/workshop/workshop-definition.yaml
        ytt -f $HOME/.local/share/workshop/workshop-definition.yaml -o json >$HOME/.local/share/workshop/workshop-definition.json
    else
        echo "{}" >$HOME/.local/share/workshop/workshop-definition.json
    fi
fi

cat $HOME/.local/share/workshop/workshop-definition.json | jq "$@"
